# LANCache Server Environment Configuration
# High School Esports LAN Infrastructure
# Generated from config.yaml

# Cache storage location
CACHE_ROOT=/data/cache
CACHE_LOGS_ROOT=/data/logs

# Cache size limits
# Set to slightly less than available disk space
CACHE_DISK_SIZE={{ (vms.lancache_server.cache_disk_size | default(30000)) }}g
CACHE_MAX_AGE=3650d  # Keep cached content for 10 years (basically forever)

# Slice configuration for cache efficiency
CACHE_SLICE_SIZE=1m

# Number of worker processes (should match CPU cores)
NGINX_WORKER_PROCESSES={{ vms.lancache_server.cores | default(4) }}

# Upstream DNS for non-cached domains
UPSTREAM_DNS={{ network.dns_primary }} {{ network.dns_secondary }}

# Bind IP (use all interfaces)
BIND_IP=0.0.0.0

# Enable access logs
ACCESS_LOG_ENABLED=true

# Cache index settings
CACHE_INDEX_SIZE=500m  # Memory for cache index

# Slice size for large files
CACHE_SLICE_SIZE=1m

# Organization branding
CACHE_NAME="{{ organization.short_name }}-LANCache"

# Timezone
TZ={{ ansible_date_time.tz | default('America/New_York') }}

# Performance tuning
CACHE_INACTIVE_TIME=90d  # Remove files not accessed in 90 days
CACHE_MIN_USES=1  # Cache on first request

# Logging
LOG_LEVEL=info  # Options: debug, info, notice, warn, error, crit

# Enable metrics endpoint for monitoring
ENABLE_METRICS=true